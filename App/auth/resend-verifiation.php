<?php 
include("../connection/conn.php");
$farmer_id = $_SESSION['fid'];
$farmer_email = $_SESSION['farmerEmail'];
$farmer_name = $_SESSION['farmerName'];
$sql = "SELECT * FROM `farmer` WHERE id = '$farmer_id';";
if ($result = mysqli_query($con, $sql)) {
    $rows = mysqli_fetch_all($result , MYSQLI_ASSOC);

    $hash = $rows[0]['mail_hash'];
    $user = $rows[0]['username'];
    if (mysqli_num_rows($result) == 1) {

        // Sending Welcome Email to New Farmer 
        $email = $farmer_email;
        $mail->addAddress($email, "VFA");
        $mail->Subject = "Welcome to VFA -AI Farming Technology";
        // $mail->MsgHTML = "$msg";
        $msg = "<!DOCTYPE html> <html lang='en' xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:v='urn:schemas-microsoft-com:vml'> <head> <title></title> <meta content='text/html; charset=utf-8' http-equiv='Content-Type' /> <meta content='width=device-width, initial-scale=1.0' name='viewport' /> <!--[if mso]><xml><o:OfficeDocumentSettings><o:PixelsPerInch>96</o:PixelsPerInch><o:AllowPNG/></o:OfficeDocumentSettings></xml><![endif]--> <style> * { box-sizing: border-box; } body { margin: 0; padding: 0; } a[x-apple-data-detectors] { color: inherit !important; text-decoration: inherit !important; } #MessageViewBody a { color: inherit; text-decoration: none; } p { line-height: inherit } .desktop_hide, .desktop_hide table { mso-hide: all; display: none; max-height: 0px; overflow: hidden; } @media (max-width:920px) { .desktop_hide table.icons-inner { display: inline-block !important; } .icons-inner { text-align: center; } .icons-inner td { margin: 0 auto; } .image_block img.big, .row-content { width: 100% !important; } .mobile_hide { display: none; } .stack .column { width: 100%; display: block; } .mobile_hide { min-height: 0; max-height: 0; max-width: 0; overflow: hidden; font-size: 0px; } .desktop_hide, .desktop_hide table { display: table !important; max-height: none !important; } } </style> </head> <body style='margin: 0; background-color: #ffffff; padding: 0; -webkit-text-size-adjust: none; text-size-adjust: none;'> <table border='0' cellpadding='0' cellspacing='0' class='nl-container' role='presentation' style='mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #ffffff; background-image: none; background-position: top left; background-size: auto; background-repeat: no-repeat;' width='100%'> <tbody> <tr> <td> <table align='center' border='0' cellpadding='0' cellspacing='0' class='row row-1' role='presentation' style='mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #ffffff;' width='100%'> <tbody> <tr> <td> <table align='center' border='0' cellpadding='0' cellspacing='0' class='row-content stack' role='presentation' style='mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #ffffff; background-position: top center; color: #000000; width: 900px;' width='900'> <tbody> <tr> <td class='column column-1' style='mso-table-lspace: 0pt; mso-table-rspace: 0pt; font-weight: 400; text-align: left; vertical-align: top; border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px;' width='50%'> <table border='0' cellpadding='0' cellspacing='0' class='text_block' role='presentation' style='mso-table-lspace: 0pt; mso-table-rspace: 0pt; word-break: break-word;' width='100%'> <tr> <td style='padding-bottom:10px;padding-left:25px;padding-right:25px;padding-top:15px;'> <div style='font-family: sans-serif'> <div class='txtTinyMce-wrapper' style='font-size: 12px; mso-line-height-alt: 14.399999999999999px; color: #1f0b0b; line-height: 1.2; font-family: Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif;'> <p style='margin: 0; font-size: 14px;'><span style='font-size:38px;'><strong><span style=''>We're happy</span></strong></span></p> <p style='margin: 0; font-size: 14px;'><span style='font-size:38px;'><strong><span style=''>you're here.</span></strong></span></p> </div> </div> </td> </tr> </table> <table border='0' cellpadding='0' cellspacing='0' class='text_block' role='presentation' style='mso-table-lspace: 0pt; mso-table-rspace: 0pt; word-break: break-word;' width='100%'> <tr> <td style='padding-bottom:25px;padding-left:25px;padding-right:25px;padding-top:10px;'> <div style='font-family: sans-serif'> <div class='txtTinyMce-wrapper' style='font-size: 12px; mso-line-height-alt: 21.6px; color: #393d47; line-height: 1.8; font-family: Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif;'> <p style='margin: 0; font-size: 18px; mso-line-height-alt: 21.6px;'> </p> <p style='margin: 0; mso-line-height-alt: 32.4px;'> <span style='font-size:18px;'>Thanks for getting started with VFA</span></p> </div> </div> </td> </tr> </table> <table border='0' cellpadding='10' cellspacing='0' class='paragraph_block' role='presentation' style='mso-table-lspace: 0pt; mso-table-rspace: 0pt; word-break: break-word;' width='100%'> <tr> <td> <div style='color:#000000;font-size:15px;font-family:'Ubuntu', Tahoma, Verdana, Segoe, sans-serif;font-weight:400;line-height:120%;text-align:left;direction:ltr;letter-spacing:0px;mso-line-height-alt:18px;'> <p style='margin: 0; margin-bottom: 16px;'>Are you ready to gain access to all of the assets we prepared for FARMERS?</p> <p style='margin: 0;'>First, you must complete your registration by clicking on the button below: </p> </div> </td> </tr> </table> <!--- Email Verification Button --> <table border='0' cellpadding='0' cellspacing='0' class='button_block' role='presentation' style='mso-table-lspace: 0pt; mso-table-rspace: 0pt;' width='100%'> <tr> <td style='padding-bottom:15px;padding-left:20px;padding-right:10px;padding-top:10px;text-align:left;'> 

        <a href='" . $base . "/App/auth/verify.php?hash=" . $hash . "&user=" . $user . "' target='_blank'> 
        <div style='text-decoration:none;display:inline-block;color:#ffffff;background-color:#00d09c;border-radius:4px;width:auto;border-top:0px solid #8a3b8f;font-weight:400;border-right:0px solid #8a3b8f;border-bottom:0px solid #8a3b8f;border-left:0px solid #8a3b8f;padding-top:10px;padding-bottom:10px;font-family:Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif;text-align:center;mso-border-alt:none;word-break:keep-all;'> <span style='padding-left:50px;padding-right:45px;font-size:16px;display:inline-block;letter-spacing:normal;'><span style='font-size: 16px; line-height: 2; word-break: break-word; mso-line-height-alt: 32px;'> <strong>Verify 
        Your Email Address
        </strong> </span> </span> </div> </a> 
        
        <!--[if mso]></center></v:textbox></v:roundrect><![endif]--> </td> </tr> </table> </td> <td class='column column-2' style='mso-table-lspace: 0pt; mso-table-rspace: 0pt; font-weight: 400; text-align: left; vertical-align: top; border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px;' width='50%'> <table border='0' cellpadding='0' cellspacing='0' class='image_block' role='presentation' style='mso-table-lspace: 0pt; mso-table-rspace: 0pt;' width='100%'> <tr> <td style='padding-right:5px;width:100%;padding-left:0px;padding-top:5px;padding-bottom:5px;'> <div align='center' style='line-height:10px'><img alt='Alternate text' class='big' src='https://i.postimg.cc/8csBKHbn/first-imag.png' style='display: block; height: auto; border: 0; width: 445px; max-width: 100%;' title='Alternate text' width='445' /></div> </td> </tr> </table> </td> </tr> </tbody> </table> </td> </tr> </tbody> </table> </td> </tr> </tbody> </table> </body> </html>";
        $mail->Body = $msg;
        $mail->AltBody = "Hello $farmer_name! <br> Welcome to VFA <br> Start your Farming journy with markets best leading AI Farming Technoly please <a href='" . $base . "app/auth/verify.php?hash=" . $hash . "&user=" . $user . "' target='_blank'> click here </a> to verify your Email <br> Thank you for Registring with us";
        $msend = false;
        try {
            $mail->send();
            $msend = true;
        } catch (Exception $e) {
            $msend = $e->getMessage();
        }
        $response = array("status" => true, "mail_status", $msend);
        echo json_encode($response);
    }
}
?>
